<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HiveMind</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/toast.css') }}">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>

<body x-data>
    <div class="container">
        <!-- Left Panel -->
        <div id="left-panel" class="panel">
            <div class="left-panel-top">
                <!-- Status Section -->
                <div class="config-section" id="status-section">
                    <h3>Status</h3>
                    <h4 class="connected" x-show="$store.chat.connected">✓ Connected</h4>
                    <h4 class="disconnected" x-show="!$store.chat.connected">✗ Disconnected</h4>
                </div>

                <!-- Quick Actions -->
                <div class="config-section">
                    <h3>Quick Actions</h3>
                    <button class="config-button" @click="resetChat()">Reset Chat</button>
                    <button class="config-button" @click="newChat()">New Chat</button>
                </div>
            </div>

            <!-- Preferences -->
            <div class="pref-section">
                <h3>Preferences</h3>
                <ul class="config-list">
                    <li>
                        <span>Autoscroll</span>
                        <label class="switch">
                            <input type="checkbox" x-model="$store.chat.autoScroll"
                                @change="toggleAutoScroll($event.target.checked)">
                            <span class="slider"></span>
                        </label>
                    </li>
                    <li>
                        <span>Dark mode</span>
                        <label class="switch">
                            <input type="checkbox" x-model="$store.chat.darkMode"
                                @change="toggleDarkMode($event.target.checked)">
                            <span class="slider"></span>
                        </label>
                    </li>
                    <li>
                        <span>Show thoughts</span>
                        <label class="switch">
                            <input type="checkbox" x-model="$store.chat.showThoughts"
                                @change="toggleThoughts($event.target.checked)">
                            <span class="slider"></span>
                        </label>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Right Panel -->
        <div id="right-panel" class="panel">
            <!-- Logo and Time -->
            <div id="logo-container">
                <img src="{{ url_for('static', filename='images/lost%20dog.jpg') | replace(' ', '%20') }}"
                    alt="HiveMind Logo" class="logo-image">
                <div id="time-date"></div>
            </div>

            <!-- Chat History -->
            <div id="chat-history"></div>

            <!-- Toast Notifications -->
            <div id="toast" class="toast">
                <div class="toast__message"></div>
                <button class="toast__copy">Copy</button>
                <button class="toast__close">Close</button>
            </div>

            <!-- Progress Bar -->
            <div id="progress-bar-box">
                <h4 id="progress-bar-h">
                    <span id="progress-bar-i">|></span>
                    <span id="progress-bar">Waiting for input...</span>
                </h4>
            </div>

            <!-- Input Section -->
            <div id="input-section">
                <textarea id="chat-input" placeholder="Type your message here..." rows="1"></textarea>
                <button class="chat-button" id="send-button" aria-label="Send message">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                        <path d="M25 20 L75 50 L25 80" fill="none" stroke="currentColor" stroke-width="15" />
                    </svg>
                </button>
                <button class="chat-button pause-button" id="pause-button" @click="pauseAgent(true)"
                    x-show="!$store.chat.paused" aria-label="Pause agent">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />
                    </svg>
                </button>
                <button class="chat-button pause-button" id="unpause-button" @click="pauseAgent(false)"
                    x-show="$store.chat.paused" aria-label="Resume agent">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M8 5v14l11-7z" />
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script type="module" src="{{ url_for('static', filename='js/messages.js') }}"></script>
    <script type="module" src="{{ url_for('static', filename='js/main.js') }}"></script>

    <!-- Initialize Alpine.js after our scripts -->
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.store('chat', {
                connected: true,
                paused: false,
                autoScroll: true,
                darkMode: localStorage.getItem('darkMode') === 'true',
                showThoughts: true
            });
        });
    </script>
</body>

</html>